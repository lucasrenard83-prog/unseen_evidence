<%= content_tag :div, class: "code-lock-overlay", data: { code_lock_target: "modal", action: "click->code-lock#closeOnBackdrop" } do %>
  <div class="code-lock-modal">
    <div class="code-lock-header">
      <h5><i class="fas fa-lock me-2"></i>Code Lock - Enter 4 digits</h5>
      <button type="button" class="btn-close btn-close-white" data-action="code-lock#close"></button>
    </div>

    <div class="code-lock-body">
      <!-- Animated lock -->
      <div class="lock-container">
        <svg class="lock-icon" data-code-lock-target="lockIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 120" width="120" height="140">
          <path class="lock-shackle" d="M 30 40 C 30 20, 70 20, 70 40 L 70 50" fill="none" stroke="#ffc107" stroke-width="8" stroke-linecap="round"/>
          <rect class="lock-body" x="20" y="50" width="60" height="50" rx="8" fill="#ffc107"/>
          <circle cx="50" cy="75" r="8" fill="#333"/>
          <rect x="47" y="75" width="6" height="15" fill="#333"/>
        </svg>
      </div>

      <!-- Code display -->
      <div class="code-dots">
        <div class="code-dot" data-code-lock-target="dot"><span></span></div>
        <div class="code-dot" data-code-lock-target="dot"><span></span></div>
        <div class="code-dot" data-code-lock-target="dot"><span></span></div>
        <div class="code-dot" data-code-lock-target="dot"><span></span></div>
      </div>

      <!-- Messages -->
      <div class="alert alert-danger d-none" data-code-lock-target="errorMessage">
        <i class="fas fa-times-circle me-2"></i>Wrong code! Try again.
      </div>
      <div class="alert alert-success d-none" data-code-lock-target="successMessage">
        <i class="fas fa-check-circle me-2"></i>Unlocked!
      </div>

      <!-- Keypad -->
      <div class="keypad">
        <div class="keypad-row">
          <button type="button" class="keypad-btn" data-action="code-lock#addDigit" data-digit="1">1</button>
          <button type="button" class="keypad-btn" data-action="code-lock#addDigit" data-digit="2">2</button>
          <button type="button" class="keypad-btn" data-action="code-lock#addDigit" data-digit="3">3</button>
        </div>
        <div class="keypad-row">
          <button type="button" class="keypad-btn" data-action="code-lock#addDigit" data-digit="4">4</button>
          <button type="button" class="keypad-btn" data-action="code-lock#addDigit" data-digit="5">5</button>
          <button type="button" class="keypad-btn" data-action="code-lock#addDigit" data-digit="6">6</button>
        </div>
        <div class="keypad-row">
          <button type="button" class="keypad-btn" data-action="code-lock#addDigit" data-digit="7">7</button>
          <button type="button" class="keypad-btn" data-action="code-lock#addDigit" data-digit="8">8</button>
          <button type="button" class="keypad-btn" data-action="code-lock#addDigit" data-digit="9">9</button>
        </div>
        <div class="keypad-row">
          <button type="button" class="keypad-btn keypad-btn-danger" data-action="code-lock#clearCode">
            <i class="fas fa-backspace"></i>
          </button>
          <button type="button" class="keypad-btn" data-action="code-lock#addDigit" data-digit="0">0</button>
          <button type="button" class="keypad-btn keypad-btn-success" data-action="code-lock#submitCode">
            <i class="fas fa-check"></i>
          </button>
        </div>
      </div>
    </div>

    <div class="code-lock-footer">
      <small>Hint: Look for clues in the library...</small>
    </div>
  </div>
<% end %>
